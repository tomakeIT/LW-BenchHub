from lwlab.distributed.proxy import RemoteEnv
env = RemoteEnv.make(address=('127.0.0.1', 50000), authkey=b'lightwheel')

from skrl.envs.wrappers.torch import wrap_env
from skrl.utils.runner.torch import Runner
import pickle
from pathlib import Path
agent_cfg_path = Path(__file__).parent / "agent_cfg.pkl"
with agent_cfg_path.open("rb") as f:
    agent_cfg = pickle.load(f)

env = wrap_env(env, wrapper="isaaclab")

runner = Runner(env, agent_cfg)
runner.run()


# import torch
# from lwlab.distributed.proxy import RemoteEnv
# env = RemoteEnv.make(address=('127.0.0.1', 50000), authkey=b'lightwheel')
# a = torch.tensor([[-4.310e-01, 6.098e-01, -1.067e+00, 3.534e-01, 1.460e+00, -1.538e+00],
#                   [-1.165e-01, 3.753e-01, 4.517e-01, -3.413e-01, -4.363e-02, 9.725e-01],
#                   [-6.027e-01, -1.789e-01, 3.423e-01, -1.632e-01, 1.234e+00, 3.644e-01],
#                   [-1.671e+00, 1.142e+00, 1.387e+00, -4.184e-01, 2.918e-01, 1.703e+00],
#                   [-4.558e-01, -9.802e-01, 9.336e-01, -6.524e-01, -9.625e-01, 1.556e-01],
#                   [-1.682e+00, 4.404e-01, -5.227e-01, -1.453e+00, -3.940e-01, 1.722e+00],
#                   [1.390e+00, 1.611e+00, -6.664e-01, 1.180e-02, -2.513e+00, 6.763e-01],
#                   [4.803e-01, -6.109e-01, 1.650e+00, -1.029e+00, -6.452e-01, -1.414e+00],
#                   [-1.190e+00, 1.955e+00, 2.230e-01, 2.855e-01, 3.366e-01, -1.812e-01],
#                   [1.283e+00, 6.471e-01, 6.060e-01, 5.861e-02, -1.385e-01, -2.359e-01],
#                   [8.381e-01, 3.933e-01, 1.829e+00, 8.724e-01, 1.891e+00, 6.406e-01],
#                   [6.502e-01, -1.298e+00, 1.027e+00, -2.532e-01, -3.396e-01, -8.014e-01],
#                   [-4.886e-02, 6.233e-01, -7.663e-01, -1.253e-01, 3.268e+00, 8.742e-01],
#                   [-3.150e-01, -6.680e-01, 1.825e-01, 3.858e-02, -5.781e-01, 2.497e+00],
#                   [9.807e-01, 5.943e-01, -1.762e+00, -2.963e-01, 3.031e-01, 4.643e-01],
#                   [-1.871e-01, 1.197e+00, 9.643e-01, -4.741e-01, 1.599e+00, -2.012e-01],
#                   [-2.015e+00, -1.132e+00, 2.727e-01, 7.711e-01, 6.277e-01, 1.139e-01],
#                   [-2.113e+00, -1.819e+00, -1.042e-01, -1.530e-01, 1.060e-01, -1.526e+00],
#                   [-3.714e-01, 1.932e+00, -4.324e-01, 1.976e+00, 1.713e+00, -1.642e-01],
#                   [-1.914e+00, 5.567e-01, 5.792e-01, -3.374e-01, 5.865e-01, 1.721e+00],
#                   [5.847e-01, 8.637e-01, -5.528e-01, -9.046e-01, -5.516e-01, -3.353e-01],
#                   [1.068e+00, -8.799e-01, -8.760e-01, 1.582e-01, 4.927e-01, -1.372e+00],
#                   [-5.166e-01, 7.219e-01, 6.079e-01, -9.354e-01, 9.564e-01, -1.900e-01],
#                   [-9.163e-01, -4.411e-02, 3.502e-01, 7.875e-01, 5.564e-02, 1.667e+00],
#                   [1.847e-01, 3.601e-01, 6.184e-01, -1.316e+00, 1.151e-01, -7.307e-01],
#                   [-3.479e-01, 5.213e-01, 3.632e-01, -9.264e-01, -6.845e-01, 5.417e-01],
#                   [-3.492e-01, 1.285e+00, -1.325e+00, -3.507e-01, -1.042e-01, 1.303e+00],
#                   [6.592e-01, 4.925e-01, -2.608e-01, 1.667e-01, -7.569e-01, -2.130e+00],
#                   [2.898e-01, 2.059e+00, -5.336e-01, 1.938e+00, 1.761e-01, 2.163e-01],
#                   [1.547e+00, 1.562e+00, -3.230e-02, -1.006e+00, 4.856e-01, 1.052e+00],
#                   [1.947e-01, 2.129e+00, -3.224e-01, -5.699e-01, 4.535e-01, -7.379e-01],
#                   [1.285e+00, 1.217e+00, -5.073e-02, -1.090e+00, -5.897e-01, -1.312e+00],
#                   [-5.219e-02, 1.748e+00, 3.558e-01, -2.817e-01, 9.081e-02, 4.024e-01],
#                   [5.663e-01, -3.551e-02, 6.403e-01, 1.482e-01, -2.445e+00, 6.775e-01],
#                   [-9.433e-01, 1.222e+00, -1.386e+00, -8.897e-01, -1.321e-02, -3.262e-01],
#                   [-6.805e-01, -8.800e-01, -4.936e-01, 1.250e+00, 9.982e-01, -3.432e-01],
#                   [6.738e-01, 8.133e-01, -3.597e-02, 6.178e-01, -1.098e-01, 2.372e-01],
#                   [-1.796e+00, 2.349e+00, 1.160e+00, -5.626e-01, -1.277e+00, -4.176e-01],
#                   [-1.026e+00, 1.078e+00, 1.133e+00, -1.202e+00, -1.706e+00, 1.278e+00],
#                   [-3.231e-01, 1.213e+00, -1.574e+00, 1.998e-01, 1.269e+00, 1.714e-01],
#                   [-8.679e-01, -1.131e+00, 1.743e-01, -8.088e-01, 9.139e-01, 5.829e-01],
#                   [-1.912e+00, 9.125e-01, -9.644e-01, 4.337e-01, 8.719e-01, 9.454e-01],
#                   [-1.767e-01, 6.193e-01, 2.431e-01, 1.527e-02, 2.237e+00, 6.261e-01],
#                   [-8.278e-01, 4.397e-01, -4.130e-01, -1.322e+00, 6.676e-01, -5.580e-01],
#                   [9.195e-01, 4.529e-01, -5.011e-01, -1.385e+00, -5.264e-01, -6.686e-01],
#                   [1.665e+00, 5.514e-01, 3.521e-01, -3.147e-02, -5.514e-01, 1.354e+00],
#                   [1.928e-01, 1.662e+00, -6.459e-01, 4.676e-02, 5.301e-01, -1.808e+00],
#                   [-8.655e-01, -1.152e+00, 2.181e-01, -3.013e-01, 6.137e-01, -1.091e+00],
#                   [-5.990e-01, 9.314e-01, -2.111e+00, -1.274e+00, 9.455e-02, 1.277e+00],
#                   [1.459e+00, 1.153e+00, -1.315e+00, 8.198e-02, 4.292e-01, 6.728e-01],
#                   [-2.677e-01, -8.767e-01, -4.907e-01, 3.897e-02, -4.296e-01, 6.855e-01],
#                   [7.824e-01, 7.298e-01, -4.501e-01, -6.075e-01, -3.956e-01, -7.607e-01],
#                   [2.254e+00, 4.021e-01, -1.577e+00, -1.578e+00, 1.339e-03, -1.317e+00],
#                   [-6.179e-01, 3.485e-01, 5.485e-01, -1.213e+00, 1.476e+00, -1.164e+00],
#                   [4.252e-01, -2.137e-01, 3.401e-01, -2.334e-01, 8.980e-01, -9.009e-02],
#                   [6.951e-01, -1.385e+00, 5.145e-01, -4.145e-01, -6.118e-01, 1.950e-01],
#                   [4.207e-01, 1.834e+00, -7.419e-01, 3.215e-01, -3.683e-02, -1.225e+00],
#                   [8.076e-01, 8.251e-01, -2.822e-01, -1.500e+00, 9.675e-01, -4.447e-01],
#                   [2.434e+00, 2.669e-02, 7.430e-01, 3.370e-01, -7.003e-01, -2.023e-01],
#                   [2.422e-01, -4.403e-01, 6.963e-01, 8.582e-01, -6.458e-01, -1.048e+00],
#                   [-6.930e-01, -2.048e-01, 3.408e-01, 2.620e-01, 9.966e-01, 3.953e-01],
#                   [-5.328e-03, 1.156e+00, 1.196e+00, 1.346e+00, -2.702e-02, 2.175e-01],
#                   [3.414e-01, 1.330e+00, -5.283e-01, -8.955e-01, 1.121e+00, -1.797e-01],
#                   [-5.182e-01, 2.846e-02, -4.457e-01, -7.156e-01, 2.352e+00, 2.486e-01],
#                   [2.865e-01, 6.768e-01, -1.134e+00, -7.274e-01, 1.981e+00, 1.137e+00],
#                   [5.177e-01, 1.224e+00, -3.025e-01, 4.946e-01, 1.533e+00, 5.409e-01],
#                   [-2.513e-01, -1.435e+00, -5.798e-01, 5.462e-01, 5.524e-01, 4.639e-01],
#                   [6.498e-01, 1.777e-01, -1.048e-01, 2.653e+00, 1.193e+00, -2.436e+00],
#                   [9.480e-01, -1.769e+00, 6.132e-01, 6.877e-01, -7.233e-01, 1.683e+00],
#                   [1.646e-01, 4.507e-01, -1.001e+00, 7.620e-01, 5.672e-02, -1.003e+00],
#                   [1.614e-01, 8.146e-03, -4.406e-01, 5.808e-01, 1.730e-01, 1.171e+00],
#                   [-4.044e-01, 2.699e+00, 2.949e+00, -4.880e-01, 2.952e-01, -7.449e-03],
#                   [-1.332e-02, -2.215e-02, -6.358e-01, 6.272e-01, 1.995e-01, 1.425e-02],
#                   [-3.898e-01, 1.623e+00, 8.033e-01, -1.356e-01, 3.339e-01, 4.019e-02],
#                   [-1.190e+00, 9.054e-01, 8.979e-01, 5.082e-01, -1.673e+00, 6.526e-02],
#                   [1.400e+00, -5.654e-01, 4.349e-01, 2.787e-02, 2.299e-01, 3.344e-01],
#                   [-1.031e+00, -1.886e+00, 6.981e-01, 5.554e-01, 2.569e-01, 1.689e+00],
#                   [-8.718e-01, -3.899e-01, 1.117e+00, -1.597e+00, -5.422e-02, 1.786e+00],
#                   [1.533e+00, -3.891e-02, 1.221e+00, 5.990e-01, 1.436e+00, 6.874e-01],
#                   [-9.055e-01, 1.190e+00, -7.530e-01, -9.946e-01, 2.172e+00, 1.264e+00],
#                   [-6.904e-01, 6.798e-01, 1.730e+00, -5.888e-01, -1.348e+00, -5.098e-01],
#                   [5.114e-01, -3.350e-01, -1.560e+00, -3.077e-01, -1.449e+00, 1.124e+00],
#                   [-1.857e+00, 1.985e+00, -1.831e+00, -1.453e+00, -1.060e+00, -6.225e-01],
#                   [-5.704e-01, 2.028e+00, -4.055e-01, -1.005e+00, 3.163e-01, 6.475e-01],
#                   [-4.379e-02, 1.857e+00, 5.065e-01, -6.811e-01, 2.407e+00, 5.891e-01],
#                   [1.737e+00, -2.007e-01, 1.111e+00, 4.106e-01, 7.908e-01, -2.807e-01],
#                   [-8.219e-01, 1.489e+00, -6.338e-01, 2.597e-01, -5.592e-01, 8.676e-01],
#                   [-2.081e-01, -8.759e-01, 1.540e+00, -5.621e-01, 8.228e-01, -1.328e+00],
#                   [6.486e-02, 5.216e-01, 1.472e+00, 1.114e+00, 3.822e-01, 3.936e-01],
#                   [-4.467e-01, 6.049e-01, 1.692e-01, 5.123e-01, 1.577e+00, -4.347e-01],
#                   [-9.500e-01, -3.550e-01, -6.529e-02, 4.352e-01, 1.102e+00, -6.352e-01],
#                   [6.936e-01, 9.522e-01, -5.590e-01, 2.319e-01, 3.635e-01, -2.689e-01],
#                   [-2.363e-01, -2.267e-01, -1.796e+00, -4.991e-02, 1.090e+00, 1.230e-01],
#                   [1.006e+00, -6.938e-01, -9.577e-01, -4.396e-01, -4.042e-01, -3.763e-01],
#                   [5.291e-02, 3.629e-01, 1.706e+00, -3.149e-01, 9.948e-01, -1.176e+00],
#                   [-5.861e-01, 1.781e+00, 8.197e-01, -9.786e-01, -1.829e+00, -7.192e-01],
#                   [3.787e-01, -1.527e+00, -3.902e-01, -3.006e-02, 9.022e-01, 2.153e-01],
#                   [-1.472e+00, -9.665e-01, 1.057e+00, -1.601e+00, 1.209e+00, 5.297e-01],
#                   [2.814e-01, 2.599e+00, 5.821e-01, -2.092e+00, 1.189e+00, 1.338e+00],
#                   [-7.382e-01, 2.782e-01, 5.763e-02, 9.999e-01, 1.543e+00, -1.060e+00]],
#                  device='cuda:0')
